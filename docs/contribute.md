<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [Contribution](#contribution)
  - [Local development](#local-development)
  - [Templates](#templates)
  - [Ruby Scripts](#ruby-scripts)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<!--
CONTRIBUTOR; WARNING
This file is generated by the /update-documentation.rb script. 
Don't edit it directly.

@see /update-documentation.rb
@see /templates/docs/contribute.md.erb
-->

# Contribution

## Local development
To debug and rebuild the images locally, you can: 
1. Clone this repository (`git clone git@github.com:decidim/docker.git decidim-docker`)
2. Run one of the docker-compose command with the version you want to build. 

| Decidim Version   | Ruby image        | Node version      | Docker-compose command |
| ----------------- | ----------------- | ----------------- | ---------------------- |
| `0.26.8`          | `ruby:2.7.8-slim-buster`| `node_16_x`       | `docker-compose -f decidim.0.26.yml up` |
| `0.27.4`          | `ruby:3.0.6-slim-buster`| `node_16_x`       | `docker-compose -f decidim.0.27.yml up` |
| `develop`         | `ruby:3.1.4-slim-buster`| `node_16_x`       | `docker-compose -f decidim.develop.yml up` |

## Templates
The templates for README, decidim.NAME_YOUR_VERSION.yml are available in the [template directory](./templates)
```
├── templates
│   ├── README.md.erb # This readme
│   ├── container-Dockerfile.erb # the Dockerfile injected in the image, present if you eject
│   ├── container-docker-compose.yml.erb # The docker-compose injected in the image, present if you eject
│   └── quickstart.yml.erb # the decidim.NAME_YOUR_VERSION.yml docker-compose template.
```

## Ruby Scripts
The scripts are all written in plain ruby. You can find the two generator scripts in this repo: 

1. ./update-registery.rb: that build the Docker image (`-build`, `-dev` and NAME_YOUR_VERSION)
2. ./update-documentation.rb: that generates the README, and the docker-compose files.

These scripts are configurable, look at the `.env.sample` file for configuration variables. 
